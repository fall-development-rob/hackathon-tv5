# =============================================================================
# Media Gateway Docker Compose Environment Configuration
# =============================================================================
# Copy this file to .env and update with your actual values
# Never commit .env to version control - it contains sensitive credentials

# =============================================================================
# PostgreSQL / RuVector Configuration
# =============================================================================

# Database Credentials
# IMPORTANT: Change these in production!
POSTGRES_USER=mediagateway
POSTGRES_PASSWORD=changeme123
POSTGRES_DB=media_gateway

# Database Port Mapping
# Change if port 5432 is already in use on your host
POSTGRES_PORT=5432

# Vector Database Configuration
# Dimension size must match your embedding model:
# - OpenAI text-embedding-ada-002: 1536
# - OpenAI text-embedding-3-small: 1536
# - OpenAI text-embedding-3-large: 3072
# - Google Vertex AI textembedding-gecko: 768
# - Sentence Transformers (all-MiniLM-L6-v2): 384
# - Sentence Transformers (all-mpnet-base-v2): 768
VECTOR_DIMENSION=768

# PostgreSQL Performance Tuning
# Adjust based on your available system resources
POSTGRES_MAX_CONNECTIONS=200
POSTGRES_SHARED_BUFFERS=256MB
POSTGRES_EFFECTIVE_CACHE_SIZE=1GB
POSTGRES_WORK_MEM=16MB
POSTGRES_MAINTENANCE_WORK_MEM=128MB

# pgvector HNSW Index Parameters
# Higher values = better search quality but slower indexing and more memory
# M: Number of bi-directional links (recommended: 16-48)
# EF_CONSTRUCTION: Size of dynamic candidate list (recommended: 64-200)
PGVECTOR_HNSW_M=16
PGVECTOR_HNSW_EF_CONSTRUCTION=64

# PostgreSQL Logging
# Options: none, ddl, mod, all
POSTGRES_LOG_STATEMENT=all
POSTGRES_LOG_DURATION=on

# Resource Limits for PostgreSQL Container
# Adjust based on your infrastructure
POSTGRES_CPU_LIMIT=2.0
POSTGRES_MEMORY_LIMIT=2G
POSTGRES_CPU_RESERVATION=0.5
POSTGRES_MEMORY_RESERVATION=512M

# =============================================================================
# pgAdmin Configuration (Optional - for database administration UI)
# =============================================================================

# pgAdmin Credentials
PGADMIN_EMAIL=admin@mediagateway.local
PGADMIN_PASSWORD=admin123
PGADMIN_PORT=5050

# =============================================================================
# Redis Configuration (Optional - for caching and rate limiting)
# =============================================================================

# Redis Connection
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_MAX_MEMORY=256mb

# =============================================================================
# Media Discovery API Configuration
# =============================================================================

# Application Server
NODE_ENV=development
API_PORT=3000

# Database Connection String
# Automatically constructed from POSTGRES_* variables in docker-compose
# For manual configuration: postgresql://user:password@host:port/database
# DATABASE_URL=postgresql://mediagateway:changeme123@ruvector-postgres:5432/media_gateway

# =============================================================================
# External API Keys
# =============================================================================

# TMDB (The Movie Database) API Configuration
# Get your API key from: https://www.themoviedb.org/settings/api
TMDB_API_KEY=your_tmdb_api_key_here
TMDB_READ_ACCESS_TOKEN=your_tmdb_read_access_token_here

# Google AI Configuration
# Gemini API for intent parsing and natural language understanding
# Get your API key from: https://makersuite.google.com/app/apikey
GOOGLE_GEMINI_API_KEY=your_google_gemini_api_key_here

# Google Vertex AI for embeddings (optional)
# Project ID for Google Cloud Vertex AI
GOOGLE_VERTEX_PROJECT_ID=your_gcp_project_id_here
GOOGLE_VERTEX_LOCATION=us-central1

# OpenAI Configuration (optional fallback for embeddings)
# Get your API key from: https://platform.openai.com/api-keys
OPENAI_API_KEY=your_openai_api_key_here

# Anthropic Claude Configuration (for agent interactions)
# Get your API key from: https://console.anthropic.com/
ANTHROPIC_API_KEY=your_anthropic_api_key_here

# =============================================================================
# Application Features
# =============================================================================

# CORS Configuration
CORS_ORIGIN=*

# Rate Limiting
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# Logging
LOG_LEVEL=info

# Session Management
SESSION_SECRET=your_session_secret_here_change_in_production

# JWT Configuration
JWT_SECRET=your_jwt_secret_here_change_in_production
JWT_EXPIRATION=7d

# =============================================================================
# Network Configuration
# =============================================================================

# Docker Network Subnet
# Change if this subnet conflicts with your network
NETWORK_SUBNET=172.28.0.0/16

# =============================================================================
# Storage Paths (for local development)
# =============================================================================

# SQLite database paths (if not using PostgreSQL)
DATABASE_PATH=./data/media-gateway.db
VECTOR_DB_PATH=./data/media-vectors.db

# Backup directory
BACKUP_PATH=./backups

# =============================================================================
# Development & Testing
# =============================================================================

# Enable debug mode
DEBUG=false

# Enable SQL query logging
SQL_DEBUG=false

# Enable vector search debug logging
VECTOR_DEBUG=false

# =============================================================================
# OpenTelemetry & Monitoring (Optional)
# =============================================================================

# OpenTelemetry Configuration
# OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4318
# OTEL_SERVICE_NAME=media-gateway-api
# OTEL_LOG_LEVEL=info

# =============================================================================
# Notes
# =============================================================================
#
# Production Deployment Checklist:
# 1. Change all default passwords and secrets
# 2. Use strong, randomly generated credentials
# 3. Enable SSL/TLS for database connections
# 4. Set up regular database backups
# 5. Configure proper resource limits
# 6. Enable monitoring and logging
# 7. Review and restrict CORS_ORIGIN
# 8. Set NODE_ENV=production
# 9. Enable Redis for caching in production
# 10. Configure proper network security groups
#
# Vector Dimension Guidelines:
# - Choose dimension based on your embedding model
# - Higher dimensions = more precise but slower and more storage
# - Common dimensions: 384, 768, 1536, 3072
# - Ensure dimension matches across all services
#
# Resource Allocation:
# - PostgreSQL: Minimum 2GB RAM for vector operations
# - Increase shared_buffers for better caching
# - Scale based on expected vector dataset size
# - Monitor query performance and adjust indices
#
# =============================================================================
